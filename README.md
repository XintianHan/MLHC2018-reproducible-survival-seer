# Machine Learning for Healthcare 2018 - Reproducible Survival Prediction with SEER Cancer Data
This repository contains the code that was used for experiments reported in _Reproducible Survival Prediction with SEER Cancer Data_ submitted to the Machine Learning for Healthcare 2018 conference.

Repository overview:
- **/bin/cluster**: slurm submission scripts for all experiments.
- **/cohort**: SEER*Stat session files to reproduce cohort selections.
- **/example**: randomly generated SEER example to test the software.
- **/example/CASES.csv**: example case export, to reproduce experiments this should be generated by loading the provided session files into SEER*Stat and exporting cases with the case listing option.
- **/example/INCIDENCES.txt**: example SEER incidences, to reproduce experiments this should be a file containing all incidences provided by SEER (e.g. by merging them together in a single file).
- **/lib**: Python classes and functions used for the experiments.
- **main.py**: main routine to execute the code.
- **requirements.txt**: Python dependencies (can be installed with pip, e.g. in a virtual environment).

To execute main.py and reproduce our experiments Python3 (we used version 3.5.2) is necessary and all dependencies in requirements.txt must be satisfied. The easiest way would be to setup an according [virtual environment and to install requirements with pip](https://docs.python.org/3/tutorial/venv.html).

The option -h gives an overview of all command line arguments. Note that this code provides some additional functionality such as SVM models and survival regression that were not used for the paper's experiments.

```
$ python main.py -h
```

An experiment with the randomly generated examples and the MLPConv model can be performed as shown below. This will produce a folder in the current directory containing results and a plot for the AUC score.

```
$ python main.py --incidences example/INCIDENCES.txt --specifications example/read.seer.research.nov2016.sas --cases example/CASES.csv --task survival60 --oneHotEncoding --model MLPConv --mlpLayers 2 --mlpWidth 20 --mlpEpochs 1 --mlpDropout 0.1 --mlpConvNeurons 3 --test --importance --plotData --plotResults
[...]
Raw data: (10000; 133) cases and attributes
Filtered SEER*Stat cases from ASCII: (5000; 133) cases and attributes
Remove irrelevant, combined, post-diagnosis, and treatment attributes: (5000; 960) cases and attributes
Create target label indicating cancer survival for survival60: (2780; 959) cases and attributes
Remove inputs with constant values: (2780; 925) cases and attributes
Data:  (2780, 925) -> x:(2780, 924), y:(2780,)
Train: x:(2224, 924), y:(2224,)
Valid: x:(278, 924), y:(278,)
Test:  x:(278, 924), y:(278,)
Embed input data.

Train on 2224 samples, validate on 278 samples
Epoch 1/1
 - 7s - loss: 0.4274 - acc: 0.8903 - val_loss: 0.4000 - val_acc: 0.8705
Validation results: auc = 0.4874885215794307, f1 = 0.9307692307692308, acc = 0.8705035971223022
Test results: auc = 0.4567588932806324, f1 = 0.9529190207156308, acc = 0.9100719424460432
```